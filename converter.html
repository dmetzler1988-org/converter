<html>
    <head>
        <title>Converter for colors and sizes</title>
    </head>
    <body>
        <div class="converter--color">
            <h2>Convert colors</h2>

            <p>Calculation examples from <a href="http://www.javascripter.net/faq/rgbtohex.htm" target="_blank">javascripter.net</a>.</p>

            <div class="converter--color-item">
                <label for="colorHex">Type in HEX color</label>
                <input id="colorHex" type="text" placeholder="#ff00ff">
            </div>

            <div class="converter--color-item">
                <label for="colorRgb">Type in RGB color</label>
                <input id="colorRgb1" type="text" placeholder="255">
                <input id="colorRgb2" type="text" placeholder="0">
                <input id="colorRgb3" type="text" placeholder="175">
            </div>

            <button class="converter--button-color" onclick="convertColors();">Convert colors</button>
            <button class="converter--button-clean" onclick="cleanColors();">Clean colors</button>

            <div class="conterter--color-outputs">
                <br/><br/>
                HEX: <span id="colorHex-output"></span><br/><br/>
                RGB: <span id="colorRgb-output"></span><br/><br/>
                CMYK: <span id="colorCmyk-output"></span><br/><br/>
                HSV: <span id="colorHsv-output"></span><br/><br/>
            </div>
        </div>

        <div class="converter--sizes">
            <h2>Convert sizes</h2>
        </div>
    </body>

    <script type="text/javascript">
        const hexField = document.getElementById('colorHex');
        const rgbField1 = document.getElementById('colorRgb1');
        const rgbField2 = document.getElementById('colorRgb2');
        const rgbField3 = document.getElementById('colorRgb3');

        const colorHexOutputField = document.getElementById('colorHex-output');
        const colorRgbOutputField = document.getElementById('colorRgb-output');
        const colorCmykOutputField = document.getElementById('colorCmyk-output');
        const colorHsvOutputField = document.getElementById('colorHsv-output');

        let hexColor = '';
        let rgbColor = '';
        let cmykColor = '';
        let hsvColor = '';

        function convertColors() {
            // HEX to RGB
            if (hexField.value !== '') {
                // RGB converter
                let R = hexToR(hexField.value);
                let G = hexToG(hexField.value);
                let B = hexToB(hexField.value);

                rgbColor = [R, G, B];
                colorRgbOutputField.innerText = 'R: ' + rgbColor[0] + ', G: ' + rgbColor[1] + ', B: ' + rgbColor[2];

                // CMYK converter
                cmykColor = hexToCMYK(hexField.value);
                colorCmykOutputField.innerText = 'C: ' + cmykColor[0] + ', M: ' + cmykColor[1] + ', Y: ' + cmykColor[2] + ', K: ' + cmykColor[3];
            }

            // RGB to HEX and CMYK
            if (rgbField1.value !== '' && rgbField2.value !== '' && rgbField3.value !== '') {
                // HEX converter
                hexColor = rgbToHex(rgbField1.value, rgbField2.value, rgbField3.value);
                colorHexOutputField.innerText = '#' + hexColor;

                // CMYK converter
                cmykColor = rgb2cmyk(rgbField1.value, rgbField2.value, rgbField3.value);
                colorCmykOutputField.innerText = 'C: ' + cmykColor[0] + ', M: ' + cmykColor[1] + ', Y: ' + cmykColor[2] + ', K: ' + cmykColor[3];

                // HSV converter
                hsvColor = rgb2hsv(rgbField1.value, rgbField2.value, rgbField3.value);
                colorHsvOutputField.innerText = 'H: ' + hsvColor[0] + ', S: ' + hsvColor[1] + ', V: ' + hsvColor[2];
            }
        }

        function cleanColors() {
            rgbField1.value = '';
            rgbField2.value = '';
            rgbField3.value = '';
            hexField.value = '';
            colorRgbOutputField.innerText = '';
            colorHexOutputField.innerText = '';
        }

        // Converter HEX to RGB.
        function rgbToHex(R, G, B) {return toHex(R) + toHex(G) + toHex(B)}
        function toHex(n) {
            n = parseInt(n, 10);
            if (isNaN(n)) return '00';
            n = Math.max(0, Math.min(n, 255));

            return '0123456789ABCDEF'.charAt((n-n%16) / 16)
                + '0123456789ABCDEF'.charAt(n % 16);
        }

        // Converter RGB to HEX.
        function hexToR(h) {return parseInt((cutHex(h)).substring(0, 2), 16)}
        function hexToG(h) {return parseInt((cutHex(h)).substring(2, 4), 16)}
        function hexToB(h) {return parseInt((cutHex(h)).substring(4, 6), 16)}
        function cutHex(h) {return (h.charAt(0) == '#') ? h.substring(1, 7) : h}

        // Converter RGB to CMYK.
        function rgb2cmyk (red, green, blue) {
            let computedC = 0;
            let computedM = 0;
            let computedY = 0;
            let computedK = 0;

            //remove spaces from input RGB values, convert to int
            let r = parseInt(('' + red).replace(/\s/g, ''), 10);
            let g = parseInt(('' + green).replace(/\s/g, ''), 10);
            let b = parseInt(('' + blue).replace(/\s/g, ''), 10);


            if (r == null || g == null || b == null || isNaN(r) || isNaN(g)|| isNaN(b)) {
                alert ('Please enter numeric RGB values!');
                return;
            }

            if (r < 0 || g < 0 || b < 0 || r > 255 || g > 255 || b > 255) {
                alert ('RGB values must be in the range 0 to 255.');
                return;
            }

            // BLACK
            if (r == 0 && g == 0 && b == 0) {
                computedK = 1;
                return [0, 0, 0, 1];
            }

            computedC = 1 - (r / 255);
            computedM = 1 - (g / 255);
            computedY = 1 - (b / 255);

            let minCMY = Math.min(computedC,
                         Math.min(computedM,computedY));
            computedC = (computedC - minCMY) / (1 - minCMY) ;
            computedM = (computedM - minCMY) / (1 - minCMY) ;
            computedY = (computedY - minCMY) / (1 - minCMY) ;
            computedK = minCMY;

            return [computedC, computedM, computedY, computedK];
        }

        // Converter RGB to HSV.
        function rgb2hsv (red, green, blue) {
            let computedH = 0;
            let computedS = 0;
            let computedV = 0;

            //remove spaces from input RGB values, convert to int
            let r = parseInt(('' + red).replace(/\s/g, ''), 10);
            let g = parseInt(('' + green).replace(/\s/g, ''), 10);
            let b = parseInt(('' + blue).replace(/\s/g, ''), 10);

            if (r == null || g == null || b == null || isNaN(r) || isNaN(g)|| isNaN(b) ) {
                alert ('Please enter numeric RGB values!');
                return;
            }

            if (r < 0 || g < 0 || b < 0 || r > 255 || g > 255 || b > 255) {
                alert ('RGB values must be in the range 0 to 255.');
                return;
            }

            r = r / 255;
            g = g / 255;
            b = b / 255;

            let minRGB = Math.min(r, Math.min(g, b));
            let maxRGB = Math.max(r, Math.max(g, b));

            // Black-gray-white
            if (minRGB == maxRGB) {
                computedV = minRGB;

                return [0, 0, computedV];
            }

            // Colors other than black-gray-white:
            let d = (r == minRGB) ? g - b : ((b == minRGB) ? r - g : b - r);
            let h = (r == minRGB) ? 3 : ((b == minRGB) ? 1 : 5);

            computedH = 60 * (h - d / (maxRGB - minRGB));
            computedS = (maxRGB - minRGB) / maxRGB;
            computedV = maxRGB;

            return [computedH, computedS, computedV];
        }

        // Converter HEX to CMYK.
        function hexToCMYK (hex) {
            let computedC = 0;
            let computedM = 0;
            let computedY = 0;
            let computedK = 0;

            hex = (hex.charAt(0) == '#') ? hex.substring(1, 7) : hex;

            if (hex.length != 6) {
                alert ('Invalid length of the input hex value!');
                return;
            }
            if (/[0-9a-f]{6}/i.test(hex) != true) {
                alert ('Invalid digits in the input hex value!');
                return;
            }

            let r = parseInt(hex.substring(0, 2), 16);
            let g = parseInt(hex.substring(2, 4), 16);
            let b = parseInt(hex.substring(4, 6), 16);

            // BLACK
            if (r == 0 && g == 0 && b == 0) {
             computedK = 1;

             return [0, 0, 0, 1];
            }

            computedC = 1 - (r / 255);
            computedM = 1 - (g / 255);
            computedY = 1 - (b / 255);

            let minCMY = Math.min(computedC, Math.min(computedM, computedY));

            computedC = (computedC - minCMY) / (1 - minCMY) ;
            computedM = (computedM - minCMY) / (1 - minCMY) ;
            computedY = (computedY - minCMY) / (1 - minCMY) ;
            computedK = minCMY;

            return [computedC, computedM, computedY, computedK];
           }
    </script>
</html>
